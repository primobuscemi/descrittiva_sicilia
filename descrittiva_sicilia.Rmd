---
title: "Analisi descrittiva COVID-19: Sicilia"
description: "analisi descrittiva."
categories:
  - R
  - "COVID-19"
  - "Sicilia"
author:
  - name: Primo Buscemi
creative_commons: CC BY-SA
date: "2020-03-15"
base_url: https://timchurches.github.io/blog/
twitter:
  creator: "@timchurches"
output:
  distill::distill_article:
    toc: true
    toc_depth: 2
    self_contained: false
repository_url: https://github.com/timchurches/blog/tree/master/_posts/2020-02-18-analysing-covid-19-2019-ncov-outbreak-data-with-r-part-1
---

```{r setup, include=FALSE}
version <- "1.8"
version_date <- lubridate::ymd("2020-02-28")
 #knitr::opts_chunk$set(echo = FALSE, cache=TRUE,
            #          tidy.opts=list(width.cutoff=60),
           #           tidy=TRUE)

#knit2wp <- function(file) {
    #require(XML)
   # content <- readLines(file)
   # content <- htmlTreeParse(content, trim=FALSE)

    ## WP will add the h1 header later based on the title, so delete here
   # content$children$html$children$body$children$h1 <- NULL
  #  content <- paste(capture.output(print(content$children$html$children$body,
  #                                        indent=FALSE, tagSeparator="")),
  #                   collapse="\n")
  #  content <- gsub("<?.body>", "", content)         # remove body tag
    
    ## enclose code snippets in SyntaxHighlighter format
  #  content <- gsub("<?pre><code class=\"r\">", "\\[code lang='r'\\]\\\n",
   #                 content)
   # content <- gsub("<?pre><code class=\"no-highlight\">", "\\[code\\]\\\n",
   #                 content)
  #  content <- gsub("<?pre><code>", "\\[code\\]\\\n", content)
 #   content <- gsub("<?/code></pre>", "\\[/code\\]\\\n", content)
  #  return(content)
#}

library(tidyverse)
library(magrittr)
library(lubridate)
library(tibble)
library(ggplot2)
library(ggthemes)
library(hrbrthemes)
library(rvest)
library(kableExtra)
library(deSolve)
library(EpiEstim)
library(incidence)
library(distcrete)
library(epitrix)
library(projections)
library(tidyr)
library(naniar)
library(purrr)
library(lubridate)
library(earlyR)
library(projections)
library(EpiEstim)


## Set the working directory to the file you are going to publish
 
setwd("/home/primo/Scrivania/descrittiva_sicilia/")



## These two packages are necessary
 
library(knitr) 
library(RWordPress)
 
## In case your packages are not working well, these packages are pre-works
 
library(XMLRPC)
library(RCurl)
library(reshape2)
library(bitops)



## Login your wordpress, give your username, your password and your wordpress website URL (don't forget to add the /xmlrpc.php after your website address)
 
options(WordPressLogin = c(filippobuscemi = 'Giovi1234'),
        WordPressURL = 'https://filippobuscemi.com/xmlrpc.php')


## Import your Rmd file to your wordpress as a draft, replace the FileName with your real filename, replace the PostTitle with your real post title.
 
knit2wp('/home/primo/Scrivania/descrittiva_sicilia/descrittiva_sicilia.Rmd',
        title = 'PostTite',
        publish = TRUE,
        action = "newPost")




#library(XMLRPC)
#library(RWordPress)
#library(knitr)



#library(RWordPress, quietly = T, warn.conflicts = F)
#library(knitr, quietly = T, warn.conflicts = F)
#library(argparser, quietly = T, warn.conflicts = F)
#library(dplyr, quietly = T, warn.conflicts = F)

# Parse script input arguments
#parser <- arg_parser("Inputs for wordpress script") %>% 
 #   add_argument(help = "/home/primo/Scrivania/descrittiva_sicilia/descrittiva_sicilia.Rmd", arg = "file") %>%
  #  add_argument(help = "title of post", arg = "title")
#args <- parse_args(parser)






#pw <- readLines(file("/home/primo/Scrivania/descrittiva_sicilia/pw.txt"))
#options(WordpressLogin = c(filippobuscemi = pw),
      #  WordpressURL = "http://www.filippobuscemi.com")

#rmd_file <- args$file
# Post thumbnail
#cat <- c('general')
# Post thumbnail
#opts_knit$set(upload.fun = function(file){library(RWordPress);uploadFile(file)$url;})
#knit2wp(rmd_file, 
       # title = args$title,
      #  categories = cat,
     #   publish = TRUE)


 #library(RWordPress)
# Set your WP username, password, and your site URL
#options(WordpressLogin = c(filippobuscemi = 'Giovi1234'), 
    #    WordpressURL = 'https://filippobuscemi.com/')
# Create a line-by-line text vector
#text = paste(readLines("/home/primo/Scrivania/descrittiva_sicilia/descrittiva_sicilia.html"), collapse = "\n")
# Send to Worpdress
#newPost(list(description = text, title = "Your post's title!"), publish = FALSE)


#library(knitr)
#library(RWordPress)
#setwd("/home/primo/Scrivania/descrittiva_sicilia")

#log into your wordpress account
#options(WordPressLogin = c(user='filippobuscemi2020@libero.it',password='Giovi1234'),
        #WordPressURL = 'https://filippobuscemi.com')
#publish your work

#newPost(content=list(description=knit2wp('descrittiva_sicilia.Rmd'),
     #                title='Workflow: Post R markdown to WordPress',
    #                 categories=c('R')),
 #       publish=FALSE)
```

```{r}
# carico i dati dal sito della protezione civile

dati_it <- "https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv"

dati_it <- read.csv(dati_it)

```

```{r}
# ottengo i dati siciliani

sicilia <- dati_it %>% filter(denominazione_regione=="Sicilia")


```

# COVID-19 : La situazione in Sicilia

```{r}

tamponi  <- tail(sicilia$tamponi, n=1)
tamponi_oggi <- tail(diff(sicilia$tamponi), n=1)

nuovi_attualmente_positivi <-  tail(sicilia$nuovi_attualmente_positivi, n=1)
nuovi_attualmente_positivi_oggi <-  tail(diff(sicilia$nuovi_attualmente_positivi), n=1)

totale_attualmente_positivi <- tail(sicilia$totale_attualmente_positivi, n=1)
totale_attualmente_positivi_oggi <- tail(sicilia$totale_attualmente_positivi_oggi, n=1)

isolamento_domiciliare  <- tail(sicilia$isolamento_domiciliare, n=1)
isolamento_domiciliare_oggi <- tail(diff(sicilia$isolamento_domiciliare), n=1)

totale_ospedalizzati  <- tail(sicilia$totale_ospedalizzati, n=1)
totale_ospedalizzati_oggi <- tail(diff(sicilia$totale_ospedalizzati), n=1)

ricoverati_con_sintomi  <- tail(sicilia$ricoverati_con_sintomi, n=1)
ricoverati_con_sintomi_oggi <- tail(diff(sicilia$ricoverati_con_sintomi), n=1)

terapia_intensiva  <- tail(sicilia$terapia_intensiva, n=1)
terapia_intensiva_oggi <- tail(diff(sicilia$terapia_intensiva), n=1)

deceduti  <- tail(sicilia$deceduti, n=1)
deceduti_oggi <- tail(diff(sicilia$deceduti), n=1)

totale_casi  <- tail(sicilia$totale_casi, n=1)

df1 <- data.frame(tamponi, nuovi_attualmente_positivi, totale_attualmente_positivi, isolamento_domiciliare, ricoverati_con_sintomi, terapia_intensiva )
kable(df1)

df2 <- data.frame(tamponi_oggi, isolamento_domiciliare_oggi, ricoverati_con_sintomi_oggi, terapia_intensiva_oggi )
kable(df2)

```

Ad oggi sono stati effettuati `r tamponi` tamponi. Nell'ultimo giorno ne sono stati effettuati `r tamponi_oggi`.
I nuovi casi (positivi al tampone... link alla who per definizione di caso) sono `r  nuovi_attualmente_positivi`. Rispetto a ieri, sono positive `r nuovi_attualmente_positivi_oggi` persone in più. I pazienti positivi al COVID-19 in Sicilia sono in tutto `r totale_attualmente_positivi`. Rispetto a ieri, `r totale_attualmente_positivi_oggi` sono positivi al coronavirus. Le persone positive al coronavirus in isolamento domiciliare sono `r isolamento_domiciliare`. Rispetto a ieri `r isolamento_domiciliare_oggi` persone in più sono in isolamento domiciliare. Il totale dei pazienti ospedalizzati è `r totale_ospedalizzati`, rispetto alla giornata di ieri sono state ospedalizzate `r totale_ospedalizzati_oggi` in più. Sono `r ricoverati_con_sintomi` i pazienti ricoverati con sintomi. Esclusa la terapia intensiva, i ricoveri ospedalieri sono `r ricoverati_con_sintomi_oggi` in più rispetto a ieri. I pazienti ricoverati in terapia intensiva sono `r terapia_intensiva`, `r terapia_intensiva_oggi` in più rispetto a ieri.  Nella giornata di oggi sono decedute `r deceduti_oggi` persone. Dall'inizio dell'epidemia sono decedute `r deceduti` persone.
Il totale dei casi registrati di COVID-19 è `r totale_casi`.










